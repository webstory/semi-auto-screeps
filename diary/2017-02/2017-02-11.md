# 2017년 2월 11일(토)

## Screeps
스크립스 타임!
Atanner 가 나한테 선전포고함. 그래서 방어를 강화하고 있다.
뉴비 존은 오늘자로 끝났다. 외부로 못나가게 막는 바리케이트도 없어졌다. 하지만 GCL3 이 되질 않아서 새틀러를 보낼 수가 없다. 2번방을 날려버리는 방법 뿐인데 굳이 그러고 싶지 않다.

타워의 공격 로직을 변경했다. 그냥 막공격하지 말고 크립의 공격력을 평가해서 위험한 순서대로 TOP3 를 선별한 후 랜덤으로 조지라고 했다. 랜덤 3를 한 이유는, 인베이더(AI)를 가지고 실험해본 결과 힐러가 빵빵하면 타워가 탱커 한놈만 계속 조지는 현상을 발견했기 때문이다. 탱커가 어그로끄는 사이 다른 딜러가 딜넣더라고. 그래서 랜덤성을 약간 부여했다. 거리에 따른 가중치는 따로 주지 않았다. 계산식이 너무 복잡해지더라.

그리고 Atanner가 자기 옆에 있던 Hawthorn을 공격해서 파멸시켰다. 구체적으로는 Rampart 하나를 집중공격해서 부수고 난입해서 Spawn을 날려버렸더라고. 그래서 나는 Spawn과 Tower에 Rampart를 씌웠다. 이렇게 하면 건물 자체의 Hit point가 극적으로 증가하는 효과를 얻는다. Nuke에는 별 도움 안되겠지만 어차피 현재의 국력(?)으로 Nuke는 못막는다. 쏘면 맞는 수밖에. Nuke는 부동산 확장 말곤 다른 수가 없다.

슬슬 CPU부하가 늘어나고 있기 때문에 스케줄러를 도입해야 한다. 각 Creep들이 자체적으로 판단하지 말고 Room마다 플래너 객체가 하나씩 있어서 매 10틱이나 100틱마다 Job assignment를 해야 한다. 방 세개까지는 현재 CPU 자원으로 커버칠 수 있는데 아래쪽 방어고지 점령 전까지는 로직을 갖춰놔야 할 것 같다.

ᅟAtanner의 Hawthorn 공격 상황을 봤다. 룸 리플레이 기능으로. ATTACK이 아니라 WORK파트를 무진장 때려박은 놈으로 철거를 눌렀구나. 이것도 고려를 해야겠다.
워커와 힐러 조합으로 와서 다때려부쉈다. 딱히 스폰을 노린 것 같지는 않고, 타워 부수고 나서 옆에 있길래 같이 부순 것에 가까워 보인다.

도로, 컨테이너, 스토리지, 링크, 벽은 부수지 않았다. 램파트, 타워, 스폰을 부쉈다. 익스텐션도 몇 부쉈는데 근처에 있으면 공격하는 로직인듯. 의외로 크립은 공격하지 않았다. 애초에 ATTACK, RANGED_ATTACK이 없다. 매뉴얼을 보면 dismantle 메소드를 썼다. 그게 적 건물을 WORK를 써서 부수는 유일한 방법이다.

처음에는 RANGED_ATTACK을 때려박은 전사를 출동시켰으나 터렛밭에 박살나고 나서 작전을 바꿨다. 하여튼 공격측은 유연하게 대응을 하니까 방어측은 더 많은 걸 생각해야 한다.
Hawthorn의 터렛은 한놈만 쏜다. 단순 로직이었다. 그래서 Atanner는 탱커+힐러 조합의 1차 특공대 투입시켜서 터렛 에너지를 고갈시켰다.
하지만 그래도 벽을 뚫고가는 건 무리이기 때문에 커스텀 로직을 만든 듯 하다. 어디서 굴러먹던 스크립트 키드는 아닌 거다.

내 기지는 Hawthorn과 달리 벽하나 뚫으면 진입되기 때문에 아마 Atanner는 통상작전용 크립을 가지고 올거다. 하지만 1차 특공대는 뭉쳐 있을거기 때문에 랜덤사격 로직이 큰 도움은 안 될 가능성이 크다. 힐러가 자힐도 가능하니까.

당연하겠지만 Atanner는 공격 상황을 주시하면서 로직을 변경했다. 중간에 벽에 대한 타겟 지정을 해제한 게 보인다. 힐러는 힐러끼리 치료가 당연히 되고, dismantle이 Rampart를 무시할 가능성도 고려해야 한다. 일단 힐러가 문제네. 힐러는 저격을 해야할듯. 힐러를 한 방에 확실히 저격할 수단이 필요하다. 터렛은 안 된다. 초근접에서 쳐맞는데도 지 수명만큼 버티는 걸 확인했거든. 적의 규모를 평가해서 힐러와 저격수를 추가로 스폰해줘야 한다. 굳이 Ranged attack하는 크립을 소환할 필요는 없을 것 같고, 아군 힐러도 어쨌든 스펙은 같을테니까.

아니군. 힐러가 Rampart에 들어가 있으면 작전이 꼬이는군. 어쨌거나 5000포인트를 한 방에 먹이지 않으면 저격은 불가능하다.
일단 Atannar는 힐러에게 HEAL 25개를 꼽으니까 근접힐 기준으로 틱당 12*25 해서 총 틱당 300을 회복한다. 최소한 틱당 300을 넘기는 대미지를 줘야 승산이 있단 얘기다. 두놈이 붙어 600이 될 수도 있지만 일단 300보다 높은 대미지가 필요하다는 점만 고려해보자.

값싼 ATTACK(80에너지)이 틱당 30으로, 이거 11개면 힐러를 이길 수 있다. 넉넉하게 15개 꼽는다고 하면 에너지 요구치가 1200이다. 다행히 본진의 에너지 동원력은 2300이다. 본진이 공격받을 때 워리어 두놈과 힐러 두놈이 있으면 어떻게 상대가 될 듯. 물론 워리어가 쳐맞아서 못움직이기 전에 힐은 해줘야 한다.

주변 방 상황을 볼 형편이 아니라서(옵저버가 없음, RCL8에나 해금) 공격 징후를 미리 감지할 순 없고, 적 크립이 세마리 넘게 들어오면 전투 상황으로 인지하는 수밖에 없겠다.

공격이 들어오면 더미들을 마구 소환해서 러시보내는 방법은 어떨까? 나나 적이나 이동과 공격을 동시에는 못한다. 그럼 거꾸로 저렴하게 TOUGH와 ATTACK정도로 구성된 떼거지를 마구 소환해 날리는거다. 터렛은 치료를 더 우선하게 세팅을 바꾸고. ... 어 이미 치료가 우선이긴 하군. 체력 50%이하의 크립을 치료한다는 로직인데, 70%로 상향한다.

주목적은 적의 처치가 아니라 기지의 방어다. 적 크립은 1500틱의 수명이 있으므로 영원히 버티지 않아도 된다. 저쪽에서 계속 보내기야 하겠지만 뭐 하루이틀 하다 포기하든지 핵날리든지 할테니까 그만큼을 버틸 정도면 족하다.

바디파트는 50개 제한이니까, 최소한의 공격력만 가진 방패병을 앞세워 배치하면 대충 막을듯. 툭툭 쳐주는 공격에 힐러는 이동이 봉쇄될 것이다. 문제는 어태커가 벽부수는 거 어떻게 막을 것이냐... 강한 공격력을 가진 딜러가 필요하긴 할 것 같은데...

renewCreep 메소드가 필요하긴 할 듯하다. 부스트를 잃어버린다지만, 알 게 뭐야. 적어도 딜러의 경우에는 스폰 비용이 매우 비싸서 상황발생했을 때 스폰하고 있을 수가 없다.


워리어 스폰 해봤는데, 시간 무지 오래 걸린다. 전투가 벌어지기 전에 최소 두놈은 대기하고 있는 게 맞다. 한놈만 스폰해서 renew가 정상적으로 되는지 테스트해봐야겠다.
일단 워리어 로직은 완성. 파츠 50개를 붙이자니 몹시 무거워져서 MOVE파트가 10개나 필요했다.