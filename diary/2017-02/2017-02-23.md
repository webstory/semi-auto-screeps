# 2017년 2월 23일(목)

## Screeps(evening)
High CPU 의 원인을 찾았다. deployer의 재귀 호출 로직이 문제를 일으켰다. 단순히 ERR_INVALID_TARGET 을 리턴하고 한 틱 쉬라고 지시하니까 CPU 소비가 확 줄었다.
내친김에 크립 액션 로직을 메인 루프 최하단에 놓고 리밋이 다가오면 강제로 루프 중단(return) 하게 만들었다.
그리고 업그레이더가 충전 타겟 갱신을 안 하는 문제를 수정. 쓸데없이 먼 데 가서 캐고 있더라.

업그레이더의 WORK는 CARRY를 나누어 떨어지게 하는 숫자로 채워야 틱 낭비가 없다. 일단 붙박이로 작업하는 특성 고려해서 CARRY 1개에 WORK 10개짜리를 RCL6부터 운영하라고 시켰다. 이거 나중에 RCL과 무관한 로직으로 변경 필요.

deployer 의 roleAnother 액션이 심각한 버그가 있는 것 같다. 월 워커에서 다시 업그레이더로 빠지면 타겟이 업그레이더로 고정돼버린다. 일단 디플로이어가 다른 일 하지 않게 막아놨다. 그리고 이렇게 돼서 가용 에너지가 바닥을 치면 RCL1 룸으로 판단해서 디플로이어를 생산하지 않는 악순환에 빠진다.

정말 절실하게 엔진 교체가 필요하다. 크립들을 전멸시키는 한이 있더라도.
방이 요구하는 요소들을 분석해서 keep을 자동 설정하게 해야 한다.